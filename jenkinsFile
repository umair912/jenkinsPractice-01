pipeline{

  agent any


  stages{
    stage('Setup NODE Environment') {
              steps {
                sh '''#!/bin/bash +x
                  set -o errexit

                  curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash
                  source ~/.nvm/nvm.sh
                  nvm install 8.0.0

                '''
              }
            }
    environment {
        CI = 'true' 
    }
    stage('Testing'){
        steps {
        sh 'npm config ls'
      }
      steps{
          sh "npm install"
          sh "npx cypress run --browser Chrome --spec Jenkins/cypress/e2e/Jenkin/jenkins.cy.js"
      }
    }
  }
  
}